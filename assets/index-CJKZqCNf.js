var ze=Object.defineProperty;var Ge=(t,a,s)=>a in t?ze(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var se=(t,a,s)=>Ge(t,typeof a!="symbol"?a+"":a,s);import{r as u,b as Je,a as Q}from"./vendor-DqFL8qPw.js";import{N as Pe,u as Ye,L as U,B as Qe,R as Xe,a as V}from"./router-Cby2BMk6.js";import{V as T,A as H,R as Ke,H as Ze,S as et,L as Ie,C as R,F as me,U as L,a as G,b as J,c as tt,M as at,D as Ae,P as $e,d as le,e as Me,f as xe,g as ue,h as F,i as ge,j as st,k as rt,l as he,m as Ee,n as pe,o as ye,p as X,q as K,B as lt,r as nt,T as Z,s as it,t as ne,u as ot,v as ct,w as dt,x as mt,O as xt}from"./ui-T1bfplez.js";import{X as ut,u as O}from"./data-BEr-VgmV.js";import{F as gt,f as Oe,s as ht,e as pt}from"./utils-D1IEH3Ga.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const m of n)if(m.type==="childList")for(const c of m.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const m={};return n.integrity&&(m.integrity=n.integrity),n.referrerPolicy&&(m.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?m.credentials="include":n.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function r(n){if(n.ep)return;n.ep=!0;const m=s(n);fetch(n.href,m)}})();var Be={exports:{}},ee={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt=u,bt=Symbol.for("react.element"),jt=Symbol.for("react.fragment"),ft=Object.prototype.hasOwnProperty,vt=yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kt={key:!0,ref:!0,__self:!0,__source:!0};function We(t,a,s){var r,n={},m=null,c=null;s!==void 0&&(m=""+s),a.key!==void 0&&(m=""+a.key),a.ref!==void 0&&(c=a.ref);for(r in a)ft.call(a,r)&&!kt.hasOwnProperty(r)&&(n[r]=a[r]);if(t&&t.defaultProps)for(r in a=t.defaultProps,a)n[r]===void 0&&(n[r]=a[r]);return{$$typeof:bt,type:t,key:m,ref:c,props:n,_owner:vt.current}}ee.Fragment=jt;ee.jsx=We;ee.jsxs=We;Be.exports=ee;var e=Be.exports,ie={},ke=Je;ie.createRoot=ke.createRoot,ie.hydrateRoot=ke.hydrateRoot;const Re=u.createContext(),Nt=()=>{const t=u.useContext(Re);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},wt=({children:t})=>{const[a,s]=u.useState(()=>{const n=localStorage.getItem("theme");return n?n==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});u.useEffect(()=>{const n=window.document.documentElement;a?n.classList.add("dark"):n.classList.remove("dark"),localStorage.setItem("theme",a?"dark":"light")},[a]);const r=()=>{s(!a)};return e.jsx(Re.Provider,{value:{isDark:a,toggleTheme:r},children:t})},g=new ut("TechWriterDB");g.version(5).stores({timeBlocks:"++id, date, type, contentType, workPhase, startTime, endTime, projectId, projectName, projectTeam",projects:"++id, name, team, status, contentType, version, lastUpdated, maintenanceStatus, createdAt",teams:"++id, name, status, color, createdAt, updatedAt",weeklySummaries:"++id, weekStart, weekEnd, createdAt",preferences:"key, value",activeTimers:"++id, startTime, type, projectId, projectName, projectTeam, description, contentType, status"});const Tt=async t=>{let a="Unknown Project",s="";if(t.projectId)try{const r=await g.projects.get(parseInt(t.projectId));r&&(a=r.name,s=r.team)}catch(r){console.error("Error fetching project details:",r)}return await g.timeBlocks.add({...t,projectName:a,projectTeam:s,createdAt:new Date().toISOString()})},be=async t=>await g.teams.add({...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),Ne=async(t,a)=>await g.teams.update(t,{...a,updatedAt:new Date().toISOString()}),St=async()=>await g.teams.where("status").equals("active").toArray(),Le=async()=>await g.teams.toArray(),Fe=async t=>await g.teams.where("name").equals(t).first(),Dt=async t=>{if(t.team&&!await Fe(t.team))throw new Error(`Team "${t.team}" does not exist`);return await g.projects.add({...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})},we=async(t,a)=>{if(a.team&&!await Fe(a.team))throw new Error(`Team "${a.team}" does not exist`);return await g.projects.update(t,{...a,updatedAt:new Date().toISOString()})},Ct=async t=>{let a="Unknown Project",s="";if(t.projectId)try{const r=await g.projects.get(parseInt(t.projectId));r&&(a=r.name,s=r.team)}catch(r){console.error("Error fetching project details:",r)}return await g.activeTimers.add({...t,projectName:a,projectTeam:s,createdAt:new Date().toISOString()})},Te=async(t,a)=>await g.activeTimers.update(t,a),Pt=async()=>await g.activeTimers.toArray(),It=async t=>{const a=await g.activeTimers.get(t);if(a){const s=new Date().toISOString(),r=Math.floor((new Date(s)-new Date(a.startTime))/1e3/60);return await Tt({type:a.type,projectId:a.projectId,projectName:a.projectName,projectTeam:a.projectTeam,description:a.description,contentType:a.contentType,date:a.startTime,startTime:a.startTime,endTime:s,duration:r,status:"completed"}),await g.activeTimers.delete(t),{duration:r,endTime:s}}},At=async()=>{if(await g.teams.count()===0){const a=[{name:"Documentation Team",description:"Main documentation and content creation team",status:"active",color:"blue"},{name:"API Team",description:"API documentation and developer resources",status:"active",color:"green"},{name:"Support Team",description:"User guides and support documentation",status:"active",color:"purple"}];for(const s of a)await be(s);console.log("Initialized default teams")}},$t=async()=>{try{await At();const t=await g.projects.toArray(),s=(await Le()).map(r=>r.name);for(const r of t)r.team&&!s.includes(r.team)&&(console.log(`Creating missing team: ${r.team}`),await be({name:r.team,description:`Auto-created from existing project: ${r.name}`,status:"active",color:"gray"}));console.log("Team migration completed successfully")}catch(t){console.error("Team migration failed:",t)}},Mt=async()=>{try{const t=await g.timeBlocks.toArray(),a=await g.projects.toArray();console.log(`Migrating ${t.length} time blocks...`);for(const s of t)if(s.projectId&&!s.projectName){const r=a.find(n=>n.id===parseInt(s.projectId));r&&(await g.timeBlocks.update(s.id,{projectName:r.name,projectTeam:r.team}),console.log(`Updated time block ${s.id} with project name: ${r.name}`))}console.log("Migration completed successfully")}catch(t){console.error("Migration failed:",t)}},Ue=u.createContext(),je=()=>{const t=u.useContext(Ue);if(!t)throw new Error("useTimer must be used within a TimerProvider");return t},Et=({children:t})=>{const[a,s]=u.useState(Date.now()),r=O(()=>Pt(),[]);u.useEffect(()=>{const y=setInterval(()=>{s(Date.now())},1e3);return()=>clearInterval(y)},[]);const n=u.useCallback(y=>{const v=new Date(y).getTime();return Math.floor((a-v)/1e3)},[a]),m=u.useCallback(async(y,v,k,j)=>{try{const D=new Date().toISOString(),C=await Ct({type:y,projectId:v,description:k,contentType:j,startTime:D,status:"active"});return T.success(`Started ${y} timer`),C}catch(D){throw T.error("Failed to start timer"),D}},[]),c=u.useCallback(async y=>{try{const v=await It(y);return T.success(`Timer stopped! Duration: ${Math.floor(v.duration/60)}h ${v.duration%60}m`),v}catch(v){throw T.error("Failed to stop timer"),v}},[]),f=u.useCallback(async y=>{try{await Te(y,{status:"paused"}),T.success("Timer paused")}catch(v){throw T.error("Failed to pause timer"),v}},[]),i=u.useCallback(async y=>{try{await Te(y,{status:"active"}),T.success("Timer resumed")}catch(v){throw T.error("Failed to resume timer"),v}},[]),o=u.useCallback(y=>{const v=n(y),k=Math.floor(v/3600),j=Math.floor(v%3600/60),D=v%60;return k>0?`${k}:${j.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}`:`${j}:${D.toString().padStart(2,"0")}`},[n]),p={activeTimers:r||[],currentTime:a,startTimer:m,stopTimer:c,pauseTimer:f,resumeTimer:i,getElapsedTime:n,getFormattedElapsedTime:o};return e.jsx(Ue.Provider,{value:p,children:t})};class W extends Q.Component{constructor(s){super(s);se(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});se(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(s){return{hasError:!0}}componentDidCatch(s,r){this.setState({error:s,errorInfo:r}),console.error("Error caught by boundary:",s,r)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 dark:from-dark-900 dark:via-dark-800 dark:to-indigo-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white/80 dark:bg-dark-800/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 dark:border-dark-700/50 p-8 text-center",children:[e.jsx("div",{className:"p-4 bg-gradient-to-br from-red-500 to-red-600 rounded-2xl shadow-lg mb-6 mx-auto w-fit",children:e.jsx(H,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Oops! Something went wrong"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:this.props.fallbackMessage||"An unexpected error occurred while loading this component."}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:this.handleReset,className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-primary-600 text-white rounded-xl font-semibold hover:bg-primary-700 transition-colors duration-300",children:[e.jsx(Ke,{className:"w-4 h-4"}),e.jsx("span",{children:"Try Again"})]}),e.jsxs("button",{onClick:()=>window.location.href="/technical-writer-dashboard/",className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-gray-600 text-white rounded-xl font-semibold hover:bg-gray-700 transition-colors duration-300",children:[e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{children:"Go Home"})]})]}),e.jsx("button",{onClick:this.handleReload,className:"mt-4 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:"Or reload the entire page"})]})}):this.props.children}}const qe=async()=>{try{const t=await g.timeBlocks.toArray(),a=await g.projects.toArray(),s=await g.teams.toArray(),r=await g.activeTimers.toArray(),n=await g.weeklySummaries.toArray(),m=await g.preferences.toArray(),c=localStorage.getItem("theme"),f={version:"2.0",exportDate:new Date().toISOString(),appVersion:"2.0.0",data:{timeBlocks:t,projects:a,teams:s,activeTimers:r,weeklySummaries:n,preferences:m},localStorageData:{theme:c,lastBackupDate:localStorage.getItem("lastBackupDate")}},i=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),o=`techwriter-backup-${new Date().toISOString().split("T")[0]}.json`;gt.saveAs(i,o),localStorage.setItem("lastBackupDate",new Date().toISOString()),T.success("Data exported successfully!")}catch(t){console.error("Export error:",t),T.error("Export failed: "+t.message)}},Ot=async t=>{try{const a=await t.text(),s=JSON.parse(a);if(!s.version||!s.data)throw new Error("Invalid backup file format");const r=parseFloat(s.version);if(r>2&&!window.confirm("This backup was created with a newer version of the app. Some data might not import correctly. Continue anyway?")||!window.confirm("This will replace all existing data. Are you sure you want to continue?"))return;const m=T.loading("Importing data...");try{if(await g.activeTimers.clear(),await g.timeBlocks.clear(),await g.weeklySummaries.clear(),await g.preferences.clear(),await g.projects.clear(),await g.teams.clear(),s.data.teams?await g.teams.bulkAdd(s.data.teams):r<2&&(console.log("Legacy import detected - creating default teams"),await Bt(s.data.projects)),s.data.projects&&await g.projects.bulkAdd(s.data.projects),s.data.timeBlocks&&await g.timeBlocks.bulkAdd(s.data.timeBlocks),s.data.activeTimers&&window.confirm("This backup contains active timers. Do you want to restore them as paused timers?")){const f=s.data.activeTimers.map(i=>({...i,status:"paused"}));await g.activeTimers.bulkAdd(f)}s.data.weeklySummaries&&await g.weeklySummaries.bulkAdd(s.data.weeklySummaries),s.data.preferences&&await g.preferences.bulkAdd(s.data.preferences),s.localStorageData&&(s.localStorageData.theme&&localStorage.setItem("theme",s.localStorageData.theme),s.localStorageData.lastBackupDate&&localStorage.setItem("lastBackupDate",s.localStorageData.lastBackupDate)),T.dismiss(m),T.success("Data imported successfully!"),setTimeout(()=>window.location.reload(),1e3)}catch(c){throw T.dismiss(m),c}}catch(a){console.error("Import error:",a),T.error("Import failed: "+a.message)}};async function Bt(t){if(!t)return;const a=[...new Set(t.map(r=>r.team).filter(Boolean))];for(const r of a)try{await g.teams.add({name:r,description:"Imported from legacy backup",status:"active",color:"gray",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}catch(n){console.error(`Failed to create team ${r}:`,n)}const s=[{name:"Documentation Team",description:"Main documentation and content creation team",status:"active",color:"blue"},{name:"API Team",description:"API documentation and developer resources",status:"active",color:"green"},{name:"Support Team",description:"User guides and support documentation",status:"active",color:"purple"}];for(const r of s)if(!a.includes(r.name))try{await g.teams.add({...r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}catch(n){console.error(`Failed to create default team ${r.name}:`,n)}}const Wt=async t=>{var a,s,r,n;try{const m=await t.text(),c=JSON.parse(m);if(!c.version||!c.data||!c.exportDate)return{valid:!1,error:"Missing required fields in backup file"};const f=["timeBlocks","projects"];for(const o of f)if(!Array.isArray(c.data[o]))return{valid:!1,error:`Invalid or missing ${o} data`};return{valid:!0,stats:{version:c.version,exportDate:new Date(c.exportDate).toLocaleString(),projects:((a=c.data.projects)==null?void 0:a.length)||0,teams:((s=c.data.teams)==null?void 0:s.length)||0,timeBlocks:((r=c.data.timeBlocks)==null?void 0:r.length)||0,activeTimers:((n=c.data.activeTimers)==null?void 0:n.length)||0}}}catch{return{valid:!1,error:"Invalid JSON format"}}},Rt=async()=>{try{const t={timeBlocks:await g.timeBlocks.count(),projects:await g.projects.count(),teams:await g.teams.count(),activeTimers:await g.activeTimers.count(),weeklySummaries:await g.weeklySummaries.count(),preferences:await g.preferences.count()},a=Object.values(t).reduce((s,r)=>s+r,0);return{counts:t,totalRecords:a,lastBackup:localStorage.getItem("lastBackupDate")}}catch(t){return console.error("Error getting export summary:",t),null}},Lt=()=>{const{isDark:t,toggleTheme:a}=Nt(),s=[{to:"/",icon:Ie,label:"Dashboard"},{to:"/time",icon:R,label:"Time Tracking"},{to:"/projects",icon:me,label:"Projects"},{to:"/teams",icon:L,label:"Teams"},{to:"/weekly",icon:G,label:"Weekly Summary"},{to:"/settings",icon:J,label:"Settings"}];return e.jsx("nav",{className:"backdrop-blur-md bg-white/80 dark:bg-dark-900/80 border-b border-white/20 dark:border-dark-700/50 sticky top-0 z-50",role:"navigation","aria-label":"Main navigation",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"flex items-center justify-between h-20",children:[e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-primary-500 to-purple-600 rounded-xl",children:e.jsx(et,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold gradient-text",children:"TechWriter"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium tracking-wider",children:"DASHBOARD"})]})]}),e.jsx("div",{className:"hidden md:flex space-x-2",children:s.map(r=>e.jsxs(Pe,{to:r.to,className:({isActive:n})=>`nav-link flex items-center space-x-2 text-sm font-medium ${n?"active":""}`,"aria-label":`Navigate to ${r.label}`,children:[e.jsx(r.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden lg:inline",children:r.label})]},r.to))})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:a,className:"relative p-3 rounded-xl bg-white/50 dark:bg-dark-700/50 backdrop-blur-sm border border-white/30 dark:border-dark-600/30 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-300 hover:scale-110 hover:shadow-lg group",title:t?"Switch to light mode":"Switch to dark mode","aria-label":t?"Switch to light mode":"Switch to dark mode",children:e.jsxs("div",{className:"relative w-5 h-5",children:[e.jsx(tt,{className:`absolute inset-0 w-5 h-5 transition-all duration-300 ${t?"rotate-90 scale-0 opacity-0":"rotate-0 scale-100 opacity-100"}`}),e.jsx(at,{className:`absolute inset-0 w-5 h-5 transition-all duration-300 ${t?"rotate-0 scale-100 opacity-100":"-rotate-90 scale-0 opacity-0"}`})]})}),e.jsxs("button",{onClick:qe,className:"flex items-center space-x-2 px-4 py-3 bg-white/50 dark:bg-dark-700/50 backdrop-blur-sm border border-white/30 dark:border-dark-600/30 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 rounded-xl text-sm font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg","aria-label":"Export data backup",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Backup"})]})]})]})})})},Ft=()=>{const t=Ye(),a=[{to:"/",icon:Ie,label:"Dashboard"},{to:"/time",icon:R,label:"Time"},{to:"/projects",icon:me,label:"Projects"},{to:"/teams",icon:L,label:"Teams"},{to:"/weekly",icon:G,label:"Weekly"},{to:"/settings",icon:J,label:"Settings"}];return e.jsx("nav",{className:"mobile-nav",role:"navigation","aria-label":"Mobile navigation",children:e.jsx("div",{className:"flex justify-around",children:a.map(s=>{const r=t.pathname===s.to;return e.jsxs(Pe,{to:s.to,className:`mobile-nav-item ${r?"active":""}`,"aria-label":`Navigate to ${s.label}`,children:[e.jsx(s.icon,{className:"w-5 h-5 mb-1"}),e.jsx("span",{children:s.label})]},s.to)})})})},_=[{value:"api-docs",label:"API Documentation",icon:"🔌",color:"blue"},{value:"user-guides",label:"User Guides",icon:"📖",color:"green"},{value:"release-notes",label:"Release Notes",icon:"📋",color:"purple"},{value:"tutorials",label:"Tutorials",icon:"🎓",color:"yellow"},{value:"technical-specs",label:"Technical Specifications",icon:"⚙️",color:"gray"},{value:"reference",label:"Reference Documentation",icon:"📚",color:"indigo"},{value:"troubleshooting",label:"Troubleshooting Guides",icon:"🔧",color:"red"},{value:"onboarding",label:"Onboarding Materials",icon:"🚀",color:"teal"},{value:"other",label:"Other Documentation",icon:"📄",color:"gray"}],oe=[{value:"research",label:"Research & Discovery",icon:"🔍",color:"blue"},{value:"writing",label:"Writing & Creation",icon:"✍️",color:"green"},{value:"review-editing",label:"Review & Editing",icon:"📝",color:"yellow"},{value:"version-updates",label:"Version Updates",icon:"🔄",color:"purple"},{value:"publishing",label:"Publishing & Distribution",icon:"📤",color:"indigo"},{value:"maintenance",label:"Maintenance & Updates",icon:"🛠️",color:"orange"}],ce=[{value:"draft-1",label:"Draft v1 (Initial)",color:"gray"},{value:"draft-2",label:"Draft v2 (Technical Review)",color:"blue"},{value:"draft-3",label:"Draft v3 (Stakeholder Review)",color:"yellow"},{value:"draft-final",label:"Draft (Final Edits)",color:"orange"},{value:"published-1-0",label:"Published v1.0",color:"green"},{value:"update-minor",label:"Update in Progress (Minor)",color:"purple"},{value:"update-major",label:"Major Revision in Progress",color:"red"},{value:"deprecated",label:"Deprecated",color:"gray"}],Se=[{value:"current",label:"Current (< 3 months)",color:"green",daysThreshold:90},{value:"stale",label:"Stale (3-6 months)",color:"yellow",daysThreshold:180},{value:"outdated",label:"Outdated (6+ months)",color:"orange",daysThreshold:365},{value:"critical",label:"Critical - Needs Urgent Update",color:"red",daysThreshold:null},{value:"deprecated",label:"Deprecated",color:"gray",daysThreshold:null}],z=t=>_.find(a=>a.value===t)||_[_.length-1],fe=t=>oe.find(a=>a.value===t)||oe[0],Ut=t=>ce.find(a=>a.value===t)||ce[0],qt=t=>Se.find(a=>a.value===t)||Se[0],te=t=>{if(!t)return"critical";const a=Math.floor((new Date-new Date(t))/(1e3*60*60*24));return a<=90?"current":a<=180?"stale":a<=365?"outdated":"critical"},Vt=()=>{const{activeTimers:t,getFormattedElapsedTime:a,pauseTimer:s,resumeTimer:r,stopTimer:n}=je();return!t||t.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2",children:t.map(m=>{const c=z(m.contentType),f=fe(m.type),i=m.status==="active";return e.jsxs("div",{className:`bg-white dark:bg-dark-800 rounded-lg shadow-lg border-l-4 p-3 min-w-64 ${i?"border-green-500 animate-pulse-soft":"border-yellow-500"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:`w-4 h-4 ${i?"text-green-600":"text-yellow-600"}`}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:i?"ACTIVE":"PAUSED"})]}),e.jsxs("div",{className:"flex space-x-1",children:[i?e.jsx("button",{onClick:()=>s(m.id),className:"p-1 text-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 rounded",title:"Pause timer",children:e.jsx($e,{className:"w-3 h-3"})}):e.jsx("button",{onClick:()=>r(m.id),className:"p-1 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded",title:"Resume timer",children:e.jsx(le,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>n(m.id),className:"p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",title:"Stop timer",children:e.jsx(Me,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:m.description||`${f.label} - ${c.label}`}),e.jsxs("div",{className:"text-gray-600 dark:text-gray-400 text-xs",children:[c.icon," ",c.label]})]}),e.jsx("div",{className:"mt-2 text-lg font-mono font-bold text-center",children:a(m.startTime)})]},m.id)})})},B=t=>Oe(new Date(t),"MMM d, yyyy"),De=t=>Oe(new Date(t),"h:mm a"),A=t=>{const a=Math.floor(t/60),s=t%60;return a>0?`${a}h ${s}m`:`${s}m`},Y=(t=new Date)=>{const a=ht(t,{weekStartsOn:1}),s=pt(t,{weekStartsOn:1});return{start:a,end:s}},$={dashboard:{recentProjects:5,todayTimeBlocks:20,documentationDebt:10},projectsPage:{itemsPerPage:20,maxVisible:100,searchDebounce:300},timeTracker:{recentSessions:50,maxSessionsDisplay:20},weeklyReport:{topProjects:10}},_t=()=>{const t=O(async()=>{const r=new Date;r.setHours(0,0,0,0);const n=new Date(r);return n.setDate(n.getDate()+1),await g.timeBlocks.where("date").between(r.toISOString(),n.toISOString()).limit($.dashboard.todayTimeBlocks).reverse().toArray()},[]),a=O(async()=>await g.projects.where("status").notEqual("archived").limit($.dashboard.recentProjects).reverse().toArray(),[]),s=O(async()=>{const r=await g.projects.where("status").notEqual("archived").toArray(),n=[],m=50;for(let c=0;c<r.length&&n.length<$.dashboard.documentationDebt;c+=m){const f=r.slice(c,c+m);for(const i of f){if(n.length>=$.dashboard.documentationDebt)break;const o=te(i.lastUpdated);(o==="outdated"||o==="critical")&&n.push({...i,maintenanceStatus:o})}c+m<r.length&&await new Promise(i=>setTimeout(i,0))}return n},[]);return{todayBlocks:t,recentActiveProjects:a,documentationDebt:s}},Ht=(t,a=$.timeTracker.recentSessions)=>{var s,r;return O(async()=>t?await g.timeBlocks.where("date").between(t.start.toISOString(),t.end.toISOString()).limit(a).reverse().toArray():[],[(s=t==null?void 0:t.start)==null?void 0:s.toISOString(),(r=t==null?void 0:t.end)==null?void 0:r.toISOString(),a])},Ce=({size:t="medium",color:a="primary",text:s=null})=>{const r={small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12"},n={primary:"border-primary-600",white:"border-white",gray:"border-gray-600"};return e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[e.jsx("div",{className:`
          ${r[t]} 
          border-2 
          ${n[a]} 
          border-t-transparent 
          rounded-full 
          animate-spin
        `,role:"status","aria-label":"Loading"}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s})]})},zt=()=>e.jsxs("div",{className:"card animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-20"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-full w-16"})]}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"})]})]}),ve=({count:t=3})=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(t)].map((a,s)=>e.jsx(zt,{},s))}),Gt=()=>{const{activeTimers:t,getFormattedElapsedTime:a}=je(),[s,r]=u.useState({totalMinutes:0,researchMinutes:0,writingMinutes:0,completedTasks:0}),{todayBlocks:n,recentActiveProjects:m,documentationDebt:c}=_t(),f=u.useMemo(()=>n?n.reduce((i,o)=>(o.duration&&(i.totalMinutes+=o.duration,o.type==="research"&&(i.researchMinutes+=o.duration),o.type==="writing"&&(i.writingMinutes+=o.duration),o.status==="completed"&&(i.completedTasks+=1)),i),{totalMinutes:0,researchMinutes:0,writingMinutes:0,completedTasks:0}):{totalMinutes:0,researchMinutes:0,writingMinutes:0,completedTasks:0},[n]);return u.useEffect(()=>{r(f)},[f]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:B(new Date)})]}),t&&t.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 px-4 py-2 rounded-lg",children:[e.jsx(R,{className:"w-5 h-5 animate-pulse"}),e.jsxs("span",{children:[t.length," Active Timer",t.length>1?"s":"",": ",a(t[0].startTime)]})]})]}),e.jsxs("div",{className:"responsive-grid lg:grid-cols-4",children:[e.jsx("div",{className:"stat-card group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"responsive-text-sm text-gray-600 dark:text-gray-400 font-medium",children:"Total Time Today"}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold gradient-text mt-2",children:A(s.totalMinutes)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"+12% from yesterday"})]}),e.jsx("div",{className:"stat-icon p-3 md:p-4 bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl shadow-lg",children:e.jsx(R,{className:"w-6 h-6 md:w-8 md:h-8 text-white"})})]})}),e.jsx("div",{className:"stat-card group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"Research Time"}),e.jsx("p",{className:"text-3xl font-bold gradient-text mt-2",children:A(s.researchMinutes)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Deep investigation"})]}),e.jsx("div",{className:"stat-icon p-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl shadow-lg",children:e.jsx(xe,{className:"w-8 h-8 text-white"})})]})}),e.jsx("div",{className:"stat-card group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"Writing Time"}),e.jsx("p",{className:"text-3xl font-bold gradient-text mt-2",children:A(s.writingMinutes)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Creative flow"})]}),e.jsx("div",{className:"stat-icon p-4 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl shadow-lg",children:e.jsx(ue,{className:"w-8 h-8 text-white"})})]})}),e.jsx("div",{className:"stat-card group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"Tasks Completed"}),e.jsx("p",{className:"text-3xl font-bold gradient-text mt-2",children:s.completedTasks}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Great progress!"})]}),e.jsx("div",{className:"stat-icon p-4 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl shadow-lg",children:e.jsx(F,{className:"w-8 h-8 text-white"})})]})})]}),c&&c.length>0&&e.jsxs("div",{className:"debt-alert card border-l-4 border-orange-500 bg-gradient-to-r from-orange-50/80 to-red-50/80 dark:from-orange-900/20 dark:to-red-900/20 backdrop-blur-sm animate-slide-up",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl animate-pulse-soft",children:e.jsx(H,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-orange-800 dark:text-orange-300",children:"Documentation Debt Alert"}),e.jsxs("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:[c.length," document",c.length>1?"s need":" needs"," immediate attention"]})]})]}),e.jsx("div",{className:"space-y-3",children:c.slice(0,3).map((i,o)=>{const p=z(i.contentType),y=te(i.lastUpdated);return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/80 dark:bg-dark-800/80 backdrop-blur-sm rounded-xl border border-orange-200/50 dark:border-orange-700/30 hover:shadow-lg transition-all duration-300",style:{animationDelay:`${o*100}ms`},children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:p.icon}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:i.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.label})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${y==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300"}`,children:y==="critical"?"🚨 Critical":"⚠️ Outdated"})]},i.id)})}),c.length>3&&e.jsx("div",{className:"mt-4 p-3 bg-white/50 dark:bg-dark-800/50 backdrop-blur-sm rounded-xl border border-orange-200/30 dark:border-orange-700/20",children:e.jsxs("p",{className:"text-sm text-orange-700 dark:text-orange-300 font-medium",children:["📚 +",c.length-3," more documents need updates"]})}),e.jsxs(U,{to:"/projects",className:"btn-primary mt-6 inline-flex items-center space-x-2 glow-effect",children:[e.jsx("span",{children:"Review Documentation Debt"}),e.jsx(H,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Today's Time Blocks"}),n===void 0?e.jsx(Ce,{text:"Loading time blocks..."}):n&&n.length>0?e.jsx("div",{className:"space-y-2",children:n.map(i=>{const o=fe(i.type),p=z(i.contentType);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-dark-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-8 rounded bg-${o.color}-500`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.description||`${o.label} - ${p.label}`}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[p.icon," ",p.label," • ",A(i.duration||0)]})]})]}),i.status==="completed"?e.jsx(F,{className:"w-5 h-5 text-green-500"}):e.jsx(ge,{className:"w-5 h-5 text-yellow-500"})]},i.id)})}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No time blocks recorded yet today."}),e.jsx(U,{to:"/time",className:"mt-4 block text-center btn-primary",children:"Start Time Tracking"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Projects"}),m===void 0?e.jsx(Ce,{text:"Loading projects..."}):m&&m.length>0?e.jsx("div",{className:"space-y-2",children:m.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[i.team," • ",i.status]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[i.progress||0,"%"]}),e.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${i.progress||0}%`}})})]})]},i.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No recent projects."}),e.jsx(U,{to:"/projects",className:"mt-4 block text-center btn-primary",children:"View All Projects"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(U,{to:"/time",className:"flex flex-col items-center p-4 bg-gray-50 dark:bg-dark-700 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-600 transition-colors",children:[e.jsx(R,{className:"w-8 h-8 text-primary-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Start Timer"})]}),e.jsxs(U,{to:"/projects",className:"flex flex-col items-center p-4 bg-gray-50 dark:bg-dark-700 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-600 transition-colors",children:[e.jsx(me,{className:"w-8 h-8 text-primary-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"New Project"})]}),e.jsxs(U,{to:"/weekly",className:"flex flex-col items-center p-4 bg-gray-50 dark:bg-dark-700 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-600 transition-colors",children:[e.jsx(G,{className:"w-8 h-8 text-primary-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Weekly Report"})]}),e.jsxs(U,{to:"/settings",className:"flex flex-col items-center p-4 bg-gray-50 dark:bg-dark-700 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-600 transition-colors",children:[e.jsx(J,{className:"w-8 h-8 text-primary-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Settings"})]})]})]})]})},Ve=(t,a=20)=>{const[s,r]=u.useState(1),n=u.useMemo(()=>{if(!t)return{items:[],totalPages:0,hasNextPage:!1,hasPrevPage:!1};const o=(s-1)*a,p=o+a,y=t.slice(o,p),v=Math.ceil(t.length/a);return{items:y,totalPages:v,hasNextPage:s<v,hasPrevPage:s>1,currentPage:s,totalItems:t.length}},[t,s,a]),m=o=>{r(Math.max(1,Math.min(o,n.totalPages)))};return{...n,goToPage:m,nextPage:()=>m(s+1),prevPage:()=>m(s-1),reset:()=>r(1),setCurrentPage:r}},Jt=(t,{threshold:a=100,limit:s=20}={})=>{const[r,n]=u.useState([]),[m,c]=u.useState(!1),[f,i]=u.useState(!0),[o,p]=u.useState(0),[y,v]=u.useState(null),k=u.useCallback(async()=>{if(!(m||!f)){c(!0),v(null);try{const C=await t(o,s);C.length<s&&i(!1),n(I=>o===0?C:[...I,...C]),p(I=>I+1)}catch(C){v(C),console.error("Error loading more data:",C)}finally{c(!1)}}},[t,o,s,m,f]),j=u.useCallback(()=>{n([]),p(0),i(!0),v(null)},[]);u.useEffect(()=>{o===0&&k()},[]);const D=u.useCallback(C=>{const{scrollTop:I,scrollHeight:d,clientHeight:w}=C.target;d-I<=w+a&&k()},[k,a]);return{data:r,loading:m,hasMore:f,error:y,loadMore:k,reset:j,handleScroll:D}},Yt=({items:t,itemHeight:a=100,containerHeight:s=400,renderItem:r,overscan:n=5})=>{const[m,c]=u.useState(0),f=u.useRef(null);if(!t||t.length===0)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No items to display"});const i=t.length*a,o=Math.ceil(s/a),p=Math.max(0,Math.floor(m/a)-n),y=Math.min(t.length-1,p+o+n*2),v=t.slice(p,y+1),k=j=>{c(j.target.scrollTop)};return e.jsx("div",{ref:f,className:"overflow-auto",style:{height:s},onScroll:k,children:e.jsx("div",{style:{height:i,position:"relative"},children:e.jsx("div",{style:{transform:`translateY(${p*a}px)`,position:"absolute",top:0,left:0,right:0},children:v.map((j,D)=>e.jsx("div",{style:{height:a},children:r(j,p+D)},p+D))})})})},_e=({currentPage:t,totalPages:a,hasNextPage:s,hasPrevPage:r,onPageChange:n,totalItems:m,itemsPerPage:c=20})=>{if(a<=1)return null;const f=(t-1)*c+1,i=Math.min(t*c,m),p=(()=>{const y=[];let k=Math.max(1,t-Math.floor(2.5)),j=Math.min(a,k+5-1);j-k+1<5&&(k=Math.max(1,j-5+1));for(let D=k;D<=j;D++)y.push(D);return y})();return e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",f," to ",i," of ",m," results"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n(t-1),disabled:!r,className:"p-2 rounded-lg border border-gray-300 dark:border-dark-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors","aria-label":"Previous page",children:e.jsx(st,{className:"w-4 h-4"})}),p[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>n(1),className:"px-3 py-2 rounded-lg border border-gray-300 dark:border-dark-600 hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors",children:"1"}),p[0]>2&&e.jsx("span",{className:"text-gray-400",children:"..."})]}),p.map(y=>e.jsx("button",{onClick:()=>n(y),className:`px-3 py-2 rounded-lg border transition-colors ${y===t?"bg-primary-600 text-white border-primary-600":"border-gray-300 dark:border-dark-600 hover:bg-gray-50 dark:hover:bg-dark-700"}`,children:y},y)),p[p.length-1]<a&&e.jsxs(e.Fragment,{children:[p[p.length-1]<a-1&&e.jsx("span",{className:"text-gray-400",children:"..."}),e.jsx("button",{onClick:()=>n(a),className:"px-3 py-2 rounded-lg border border-gray-300 dark:border-dark-600 hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors",children:a})]}),e.jsx("button",{onClick:()=>n(t+1),disabled:!s,className:"p-2 rounded-lg border border-gray-300 dark:border-dark-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors","aria-label":"Next page",children:e.jsx(rt,{className:"w-4 h-4"})})]})]})},re=Q.memo(({block:t})=>{const a=fe(t.type),s=z(t.contentType),r=a.value==="research"?xe:a.value==="writing"?ue:a.value==="review-editing"?G:a.value==="version-updates"?he:a.value==="publishing"?Ee:J;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-dark-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 bg-${a.color}-100 rounded-lg`,children:Q.createElement(r,{className:`w-5 h-5 text-${a.color}-600`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.description||`${a.label} - ${s.label}`}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.icon," ",s.label," • ",De(t.startTime)," - ",t.endTime?De(t.endTime):"In progress"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:A(t.duration||0)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.label})]})]})}),Qt=()=>{const{activeTimers:t,startTimer:a,stopTimer:s,pauseTimer:r,resumeTimer:n,getFormattedElapsedTime:m}=je(),[c,f]=u.useState("writing"),[i,o]=u.useState("user-guides"),[p,y]=u.useState(""),[v,k]=u.useState(""),[j,D]=u.useState(!1),C=O(()=>g.projects.where("status").notEqual("archived").limit(50).toArray(),[]),I=u.useMemo(()=>{const x=new Date;x.setHours(0,0,0,0);const q=new Date(x);return q.setDate(q.getDate()+1),{start:x,end:q}},[]),d=Ht(I,$.timeTracker.maxSessionsDisplay),w=Ve(d||[],$.timeTracker.maxSessionsDisplay),S=async(x,q)=>{const He=x*q,ae=new Date;return ae.setDate(ae.getDate()-1),await g.timeBlocks.where("date").below(ae.toISOString()).reverse().offset(He).limit(q).toArray()},{data:M,loading:E,hasMore:b,error:h,handleScroll:N}=Jt(S,{threshold:100,limit:$.timeTracker.recentSessions}),l=oe.map(x=>({value:x.value,label:x.label,icon:x.value==="research"?xe:x.value==="writing"?ue:x.value==="review-editing"?G:x.value==="version-updates"?he:x.value==="publishing"?Ee:J,color:x.color})),P=async()=>{if(!p){T.error("Please select a project");return}if(!v.trim()){T.error("Please provide a task description");return}try{await a(c,p,v,i),k("")}catch(x){console.error("Failed to start timer:",x)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Time Tracking"}),e.jsx("div",{className:"card text-center",children:t&&t.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-6xl font-mono font-bold text-gray-900 dark:text-gray-100 mb-4",children:m(t[0].startTime)}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:t[0].description||`${t[0].type} - ${t[0].contentType}`}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[t[0].status==="active"?e.jsxs("button",{onClick:()=>r(t[0].id),className:"btn-secondary flex items-center space-x-2",children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{children:"Pause"})]}):e.jsxs("button",{onClick:()=>n(t[0].id),className:"btn-primary flex items-center space-x-2",children:[e.jsx(le,{className:"w-5 h-5"}),e.jsx("span",{children:"Resume"})]}),e.jsxs("button",{onClick:()=>s(t[0].id),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium flex items-center space-x-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx("span",{children:"Stop"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-6xl font-mono font-bold text-gray-900 dark:text-gray-100 mb-4",children:"0:00"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Work Phase"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map(x=>e.jsxs("button",{onClick:()=>f(x.value),className:`p-3 rounded-lg border-2 transition-all ${c===x.value?`border-${x.color}-500 bg-${x.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(x.icon,{className:`w-5 h-5 mx-auto mb-1 ${c===x.value?`text-${x.color}-600`:"text-gray-600 dark:text-gray-400"}`}),e.jsx("span",{className:"text-xs text-center",children:x.label})]},x.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Content Type"}),e.jsx("select",{value:i,onChange:x=>o(x.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:_.map(x=>e.jsxs("option",{value:x.value,children:[x.icon," ",x.label]},x.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Project"}),e.jsxs("select",{value:p,onChange:x=>y(x.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200","aria-describedby":"project-error",required:!0,children:[e.jsx("option",{value:"",children:"Select a project..."}),C==null?void 0:C.map(x=>e.jsxs("option",{value:x.id,children:[x.name," (",x.team,")"]},x.id))]}),!p&&e.jsx("p",{id:"project-error",className:"mt-1 text-sm text-red-600",children:"Project selection is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),e.jsx("input",{type:"text",value:v,onChange:x=>k(x.target.value),placeholder:"What specific task are you working on?",className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200","aria-describedby":"description-error",required:!0}),!v.trim()&&e.jsx("p",{id:"description-error",className:"mt-1 text-sm text-red-600",children:"Task description is required"})]}),e.jsxs("button",{onClick:P,className:"btn-primary flex items-center justify-center space-x-2 w-full",children:[e.jsx(le,{className:"w-5 h-5"}),e.jsx("span",{children:"Start Timer"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Today's Sessions"}),d&&d.length>$.timeTracker.maxSessionsDisplay&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",w.items.length," of ",d.length," sessions"]})]}),d===void 0?e.jsx(ve,{count:3}):d&&d.length>0?e.jsxs(e.Fragment,{children:[d.length>$.timeTracker.maxSessionsDisplay?e.jsx(Yt,{items:w.items,itemHeight:80,containerHeight:400,renderItem:x=>e.jsx(re,{block:x},x.id)}):e.jsx("div",{className:"space-y-3",children:w.items.map(x=>e.jsx(re,{block:x},x.id))}),d.length>$.timeTracker.maxSessionsDisplay&&e.jsx("div",{className:"mt-6",children:e.jsx(_e,{currentPage:w.currentPage,totalPages:w.totalPages,hasNextPage:w.hasNextPage,hasPrevPage:w.hasPrevPage,onPageChange:w.goToPage,totalItems:w.totalItems,itemsPerPage:$.timeTracker.maxSessionsDisplay})})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No time blocks recorded today yet."})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Time Block History"}),e.jsx("button",{onClick:()=>D(!j),className:"btn-secondary",children:j?"Hide History":"Show History"})]}),j&&e.jsx("div",{children:h?e.jsxs("div",{className:"text-red-600 dark:text-red-400 text-center py-4",children:["Error loading history: ",h.message]}):M.length===0&&!E?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No historical time blocks found."}):e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",onScroll:N,children:[M.map(x=>e.jsx(re,{block:x},x.id)),E&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading more..."})]})}),!b&&M.length>0&&e.jsx("div",{className:"text-center py-4 text-sm text-gray-500 dark:text-gray-400",children:"No more history to load"})]})})]})]})},de=u.memo(({project:t,onEdit:a,onArchive:s,getStatusIcon:r,getStatusColor:n,getPriorityColor:m,statuses:c,priorities:f})=>{var j,D;const i=r(t.status),o=n(t.status),p=m(t.priority),y=z(t.contentType),v=Ut(t.version),k=qt(t.maintenanceStatus||te(t.lastUpdated));return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h4",{className:"text-lg font-semibold",children:t.name}),e.jsx("span",{className:"text-lg",children:y.icon})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.team," • ",y.label]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:v.label})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>a(t),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100","aria-label":"Edit project",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>s(t.id),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100","aria-label":"Archive project",children:e.jsx(ye,{className:"w-4 h-4"})})]})]}),t.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:t.description}),(k.value==="outdated"||k.value==="critical")&&e.jsxs("div",{className:`flex items-center space-x-2 p-2 mb-3 rounded-lg bg-${k.color}-50 border border-${k.color}-200`,children:[e.jsx(H,{className:`w-4 h-4 text-${k.color}-600`}),e.jsxs("span",{className:`text-sm text-${k.color}-700`,children:["Documentation Debt: ",k.label]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`flex items-center space-x-1 text-sm px-2 py-1 bg-${o}-100 text-${o}-700 rounded`,children:[e.jsx(i,{className:"w-4 h-4"}),e.jsx("span",{children:(j=c.find(C=>C.value===t.status))==null?void 0:j.label})]}),e.jsx("span",{className:`text-sm px-2 py-1 bg-${p}-100 text-${p}-700 rounded`,children:(D=f.find(C=>C.value===t.priority))==null?void 0:D.label})]}),t.dueDate&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Due: ",B(t.dueDate)]})]}),t.lastUpdated&&e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["Last updated: ",B(t.lastUpdated)]}),e.jsx("span",{className:`px-2 py-1 rounded bg-${k.color}-100 text-${k.color}-700`,children:k.label})]})]})]})});de.displayName="ProjectCard";const Xt=(t,a)=>{let s;return function(...n){const m=()=>{clearTimeout(s),t(...n)};clearTimeout(s),s=setTimeout(m,a)}},Kt=()=>{const[t,a]=u.useState(!1),[s,r]=u.useState(null),[n,m]=u.useState(""),[c,f]=u.useState({status:"all",team:"all",contentType:"all"}),[i,o]=u.useState({name:"",team:"",description:"",status:"planning",priority:"medium",dueDate:"",contentType:"user-guides",version:"draft-1",lastUpdated:new Date().toISOString().split("T")[0]}),p=O(()=>g.projects.reverse().toArray(),[]),y=O(()=>St(),[]),v=O(()=>Le(),[]),k=u.useMemo(()=>p?p.filter(l=>{if(n){const P=n.toLowerCase();if(!(l.name.toLowerCase().includes(P)||l.team&&l.team.toLowerCase().includes(P)||l.description&&l.description.toLowerCase().includes(P)))return!1}return!(c.status!=="all"&&l.status!==c.status||c.team!=="all"&&l.team!==c.team||c.contentType!=="all"&&l.contentType!==c.contentType)}):[],[p,n,c]),j=Ve(k,$.projectsPage.itemsPerPage),D=u.useMemo(()=>Xt(l=>m(l),$.projectsPage.searchDebounce),[]),C=u.useMemo(()=>v?v.filter(l=>l.status==="active"):[],[v]),I=[{value:"planning",label:"Planning",color:"blue"},{value:"in-progress",label:"In Progress",color:"yellow"},{value:"review",label:"Review",color:"purple"},{value:"published",label:"Published",color:"green"},{value:"archived",label:"Archived",color:"gray"}],d=[{value:"high",label:"High",color:"red"},{value:"medium",label:"Medium",color:"yellow"},{value:"low",label:"Low",color:"green"}],w=()=>{const l=[];return i.name.trim()||l.push("Project name is required"),i.team||l.push("Team selection is required"),i.dueDate&&new Date(i.dueDate)<new Date&&l.push("Due date cannot be in the past"),l},S=async l=>{l.preventDefault();const P=w();if(P.length>0){P.forEach(x=>T.error(x));return}try{const x={...i,maintenanceStatus:te(i.lastUpdated)};s?(await we(s.id,x),T.success("Project updated successfully")):(await Dt(x),T.success("Project created successfully")),o({name:"",team:"",description:"",status:"planning",priority:"medium",dueDate:"",contentType:"user-guides",version:"draft-1",lastUpdated:new Date().toISOString().split("T")[0]}),a(!1),r(null)}catch{T.error("Failed to save project")}},M=u.useCallback(l=>{r(l),o({name:l.name,team:l.team,description:l.description||"",status:l.status,priority:l.priority||"medium",dueDate:l.dueDate||"",contentType:l.contentType||"user-guides",version:l.version||"draft-1",lastUpdated:l.lastUpdated||new Date().toISOString().split("T")[0]}),a(!0)},[]),E=u.useCallback(async l=>{await we(l,{status:"archived"}),T.success("Project archived")},[]),b=l=>{switch(l){case"planning":return R;case"in-progress":return ge;case"review":return pe;case"published":return F;case"archived":return ye;default:return K}},h=l=>{const P=I.find(x=>x.value===l);return P?P.color:"gray"},N=l=>{const P=d.find(x=>x.value===l);return P?P.color:"gray"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Projects"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[j.totalItems," total projects ",k.length!==(p==null?void 0:p.length)&&`(${k.length} filtered)`]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>window.location.href="/technical-writer-dashboard/teams",className:"btn-secondary flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"Manage Teams"})]}),e.jsxs("button",{onClick:()=>a(!t),className:"btn-primary flex items-center space-x-2",children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{children:"New Project"})]})]})]}),y&&y.length===0&&e.jsx("div",{className:"card border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(H,{className:"w-6 h-6 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800 dark:text-yellow-300",children:"No Teams Available"}),e.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:["You need to create teams before adding projects.",e.jsx("button",{onClick:()=>window.location.href="/technical-writer-dashboard/teams",className:"ml-1 underline hover:no-underline",children:"Manage teams here"})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Search Projects"}),e.jsx("input",{type:"text",placeholder:"Search by name, team, or description...",onChange:l=>D(l.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:c.status,onChange:l=>f(P=>({...P,status:l.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:[e.jsx("option",{value:"all",children:"All Statuses"}),I.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Team"}),e.jsxs("select",{value:c.team,onChange:l=>f(P=>({...P,team:l.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:[e.jsx("option",{value:"all",children:"All Teams"}),C.map(l=>e.jsx("option",{value:l.name,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Content Type"}),e.jsxs("select",{value:c.contentType,onChange:l=>f(P=>({...P,contentType:l.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:[e.jsx("option",{value:"all",children:"All Types"}),_.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]})]})}),t&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:s?"Edit Project":"New Project"}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Name"}),e.jsx("input",{type:"text",value:i.name,onChange:l=>o({...i,name:l.target.value}),required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200","aria-describedby":"name-error"}),!i.name.trim()&&e.jsx("p",{id:"name-error",className:"mt-1 text-sm text-red-600",children:"Project name is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Content Type"}),e.jsx("select",{value:i.contentType,onChange:l=>o({...i,contentType:l.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:_.map(l=>e.jsxs("option",{value:l.value,children:[l.icon," ",l.label]},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Team"}),e.jsxs("select",{value:i.team,onChange:l=>o({...i,team:l.target.value}),required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200","aria-describedby":"team-error",children:[e.jsx("option",{value:"",children:"Select team..."}),y==null?void 0:y.map(l=>e.jsx("option",{value:l.name,children:l.name},l.id))]}),!i.team&&e.jsx("p",{id:"team-error",className:"mt-1 text-sm text-red-600",children:"Team selection is required"}),y&&y.length===0&&e.jsxs("p",{className:"mt-1 text-sm text-orange-600",children:["No teams available.",e.jsx("button",{type:"button",onClick:()=>window.location.href="/technical-writer-dashboard/teams",className:"ml-1 underline hover:no-underline",children:"Create a team first"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Document Version"}),e.jsx("select",{value:i.version,onChange:l=>o({...i,version:l.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:ce.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsx("select",{value:i.status,onChange:l=>o({...i,status:l.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:I.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),e.jsx("select",{value:i.priority,onChange:l=>o({...i,priority:l.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:d.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:i.dueDate,onChange:l=>o({...i,dueDate:l.target.value}),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200","aria-describedby":"due-date-error"}),i.dueDate&&new Date(i.dueDate)<new Date&&e.jsx("p",{id:"due-date-error",className:"mt-1 text-sm text-red-600",children:"Due date cannot be in the past"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last Updated"}),e.jsx("input",{type:"date",value:i.lastUpdated,onChange:l=>o({...i,lastUpdated:l.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:l=>o({...i,description:l.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{a(!1),r(null),o({name:"",team:"",description:"",status:"planning",priority:"medium",dueDate:"",contentType:"user-guides",version:"draft-1",lastUpdated:new Date().toISOString().split("T")[0]})},className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",disabled:y&&y.length===0,children:[s?"Update":"Create"," Project"]})]})]})]}),p===void 0?e.jsx(ve,{count:4}):k.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:p.length===0?"No projects yet. Create your first project!":"No projects match your filters. Try adjusting your search criteria."})]}):e.jsxs(e.Fragment,{children:[k.length>$.projectsPage.maxVisible?e.jsx(VirtualizedList,{items:j.items,itemHeight:200,containerHeight:600,renderItem:l=>e.jsx("div",{className:"p-2",children:e.jsx(de,{project:l,onEdit:M,onArchive:E,getStatusIcon:b,getStatusColor:h,getPriorityColor:N,statuses:I,priorities:d},l.id)})}):e.jsx("div",{className:"responsive-grid",children:j.items.map(l=>e.jsx(de,{project:l,onEdit:M,onArchive:E,getStatusIcon:b,getStatusColor:h,getPriorityColor:N,statuses:I,priorities:d},l.id))}),e.jsx(_e,{currentPage:j.currentPage,totalPages:j.totalPages,hasNextPage:j.hasNextPage,hasPrevPage:j.hasPrevPage,onPageChange:j.goToPage,totalItems:j.totalItems,itemsPerPage:$.projectsPage.itemsPerPage})]})]})},Zt=()=>{const[t,a]=u.useState(!1),[s,r]=u.useState(null),[n,m]=u.useState("teams"),[c,f]=u.useState({name:"",description:"",lead:"",status:"active",color:"blue"}),i=O(()=>g.teams.reverse().toArray(),[]),o=O(async()=>{if(!i)return{};const d={};for(const w of i){const S=await g.projects.where("team").equals(w.name).count(),M=await g.projects.where("team").equals(w.name).and(P=>P.status!=="archived").count(),E=await g.timeBlocks.where("projectTeam").equals(w.name).toArray(),b=E.reduce((P,x)=>P+(x.duration||0),0),h=new Date;h.setDate(h.getDate()-30);const N=E.filter(P=>new Date(P.startTime)>=h),l=N.reduce((P,x)=>P+(x.duration||0),0);d[w.id]={totalProjects:S,activeProjects:M,totalTime:b,recentTime:l,recentBlocks:N.length}}return d},[i]),p=[{value:"blue",label:"Blue",bgClass:"bg-blue-100",textClass:"text-blue-700",borderClass:"border-blue-500"},{value:"green",label:"Green",bgClass:"bg-green-100",textClass:"text-green-700",borderClass:"border-green-500"},{value:"purple",label:"Purple",bgClass:"bg-purple-100",textClass:"text-purple-700",borderClass:"border-purple-500"},{value:"yellow",label:"Yellow",bgClass:"bg-yellow-100",textClass:"text-yellow-700",borderClass:"border-yellow-500"},{value:"red",label:"Red",bgClass:"bg-red-100",textClass:"text-red-700",borderClass:"border-red-500"},{value:"indigo",label:"Indigo",bgClass:"bg-indigo-100",textClass:"text-indigo-700",borderClass:"border-indigo-500"},{value:"pink",label:"Pink",bgClass:"bg-pink-100",textClass:"text-pink-700",borderClass:"border-pink-500"},{value:"teal",label:"Teal",bgClass:"bg-teal-100",textClass:"text-teal-700",borderClass:"border-teal-500"}],y=()=>{const d=[];return c.name.trim()||d.push("Team name is required"),i&&i.find(S=>S.name.toLowerCase()===c.name.toLowerCase()&&(!s||S.id!==s.id))&&d.push("A team with this name already exists"),d},v=async d=>{d.preventDefault();const w=y();if(w.length>0){w.forEach(S=>T.error(S));return}try{s?(await Ne(s.id,c),T.success("Team updated successfully")):(await be(c),T.success("Team created successfully")),k()}catch{T.error("Failed to save team")}},k=()=>{f({name:"",description:"",lead:"",status:"active",color:"blue"}),a(!1),r(null)},j=d=>{r(d),f({name:d.name,description:d.description||"",lead:d.lead||"",status:d.status,color:d.color||"blue"}),a(!0)},D=async d=>{const w=i.find(E=>E.id===d),S=o==null?void 0:o[d];if((S==null?void 0:S.activeProjects)>0){T.error(`Cannot archive team with ${S.activeProjects} active projects`);return}window.confirm(`Are you sure you want to archive "${w.name}"? This action can be undone later.`)&&(await Ne(d,{status:"archived"}),T.success("Team archived"))},C=d=>p.find(S=>S.value===d)||p[0],I=u.useMemo(()=>{if(!i||!o)return null;const d=i.filter(h=>h.status==="active"),w=Object.values(o).reduce((h,N)=>h+N.totalProjects,0),S=Object.values(o).reduce((h,N)=>h+N.activeProjects,0),M=Object.values(o).reduce((h,N)=>h+N.totalTime,0),E=Object.values(o).reduce((h,N)=>h+N.recentTime,0),b=d.map(h=>({...h,stats:o[h.id]||{}})).sort((h,N)=>N.stats.recentTime-h.stats.recentTime).slice(0,5);return{activeTeams:d.length,totalProjects:w,totalActiveProjects:S,totalTime:M,totalRecentTime:E,topPerformingTeams:b}},[i,o]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Team Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage teams and track productivity across your organization"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex bg-gray-100 dark:bg-dark-700 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>m("teams"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${n==="teams"?"bg-white dark:bg-dark-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,children:[e.jsx(L,{className:"w-4 h-4 inline mr-2"}),"Teams"]}),e.jsxs("button",{onClick:()=>m("dashboard"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${n==="dashboard"?"bg-white dark:bg-dark-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,children:[e.jsx(lt,{className:"w-4 h-4 inline mr-2"}),"Dashboard"]})]}),n==="teams"&&e.jsxs("button",{onClick:()=>a(!t),className:"btn-primary flex items-center space-x-2",children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{children:"New Team"})]})]})]}),n==="teams"?e.jsxs(e.Fragment,{children:[t&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:s?"Edit Team":"New Team"}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Team Name *"}),e.jsx("input",{type:"text",value:c.name,onChange:d=>f({...c,name:d.target.value}),required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",placeholder:"e.g., Frontend Team, API Documentation Team"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Team Lead"}),e.jsx("input",{type:"text",value:c.lead,onChange:d=>f({...c,lead:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",placeholder:"Team lead name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:c.status,onChange:d=>f({...c,status:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Team Color"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:p.map(d=>e.jsxs("button",{type:"button",onClick:()=>f({...c,color:d.value}),className:`p-3 rounded-lg border-2 transition-all ${c.color===d.value?`${d.borderClass} ${d.bgClass}`:"border-gray-200 dark:border-dark-600 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-4 h-4 mx-auto rounded-full bg-${d.value}-500`}),e.jsx("span",{className:"text-xs mt-1 block",children:d.label})]},d.value))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:c.description,onChange:d=>f({...c,description:d.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-dark-800 dark:text-gray-200",placeholder:"Brief description of the team's responsibilities"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:k,className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",children:[s?"Update":"Create"," Team"]})]})]})]}),i===void 0?e.jsx(ve,{count:3}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No teams yet. Create your first team to get started!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(d=>{const w=C(d.color),S=(o==null?void 0:o[d.id])||{totalProjects:0,activeProjects:0,totalTime:0,recentTime:0};return e.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl ${w.bgClass} flex items-center justify-center`,children:e.jsx(L,{className:`w-6 h-6 ${w.textClass}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-lg font-semibold truncate",children:d.name}),d.lead&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Led by ",d.lead]})]})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>j(d),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-700",title:"Edit team",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D(d.id),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-700",title:"Archive team",children:e.jsx(ye,{className:"w-4 h-4"})})]})]}),d.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2",children:d.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`flex items-center space-x-1 text-sm px-3 py-1 rounded-full ${d.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"}`,children:[d.status==="active"?e.jsx(F,{className:"w-3 h-3"}):e.jsx(ge,{className:"w-3 h-3"}),e.jsx("span",{className:"capitalize",children:d.status})]}),d.createdAt&&e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Created ",B(d.createdAt)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:S.totalProjects}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Total Projects"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(nt,{className:"w-4 h-4 text-primary-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-primary-600",children:S.activeProjects}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Active"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:A(S.totalTime)}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Total Time"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:A(S.recentTime)}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Last 30 Days"})]})]})]})]})]},d.id)})})]}):e.jsx("div",{className:"space-y-6",children:I&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active Teams"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:I.activeTeams})]}),e.jsx(L,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Projects"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:I.totalProjects}),e.jsxs("p",{className:"text-xs text-green-600",children:[I.totalActiveProjects," active"]})]}),e.jsx(K,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Time Tracked"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(I.totalTime)})]}),e.jsx(R,{className:"w-8 h-8 text-purple-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recent Activity"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(I.totalRecentTime)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Last 30 days"})]}),e.jsx(Z,{className:"w-8 h-8 text-orange-500"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Top Performing Teams (Last 30 Days)"}),e.jsx("div",{className:"space-y-3",children:I.topPerformingTeams.map((d,w)=>{const S=C(d.color),M=d.stats;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-dark-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${S.bgClass} flex items-center justify-center`,children:e.jsx(L,{className:`w-5 h-5 ${S.textClass}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:d.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["#",w+1]})]}),d.lead&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Led by ",d.lead]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-lg",children:A(M.recentTime)}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[M.activeProjects," active projects"]})]})]},d.id)})})]})]})})]})},ea=t=>({research:"deepWork",writing:"deepWork","review-editing":"deepWork","version-updates":"shallowWork",publishing:"shallowWork",maintenance:"shallowWork",meeting:"meetings",planning:"planning"})[t]||"other",ta=()=>{const[t,a]=u.useState(Y()),[s,r]=u.useState([""]),[n,m]=u.useState([""]),[c,f]=u.useState(""),i=O(async()=>await g.timeBlocks.where("date").between(t.start.toISOString(),t.end.toISOString()).toArray(),[t]),o=u.useMemo(()=>i?i.reduce((b,h)=>{if(h.duration)switch(b.total+=h.duration,ea(h.type)){case"deepWork":b.deepWork+=h.duration;break;case"shallowWork":b.shallowWork+=h.duration;break;case"meetings":b.meetings+=h.duration;break;case"planning":b.planning+=h.duration;break}return b},{total:0,deepWork:0,shallowWork:0,meetings:0,planning:0}):{total:0,deepWork:0,shallowWork:0,meetings:0,planning:0},[i]),p=u.useMemo(()=>{if(!i)return[];const b={};return i.forEach(h=>{if(h.projectId&&h.duration){const N=`${h.projectId}`;b[N]||(b[N]={projectId:h.projectId,projectName:h.projectName||"Unknown Project",projectTeam:h.projectTeam||"",minutes:0}),b[N].minutes+=h.duration}}),Object.values(b).sort((h,N)=>N.minutes-h.minutes)},[i]),y=()=>{r([...s,""])},v=b=>{r(s.filter((h,N)=>N!==b))},k=(b,h)=>{const N=[...s];N[b]=h,r(N)},j=()=>{m([...n,""])},D=b=>{m(n.filter((h,N)=>N!==b))},C=(b,h)=>{const N=[...n];N[b]=h,m(N)},I=()=>{const b=s.filter(l=>l.trim()!==""),h=n.filter(l=>l.trim()!==""),N=`Weekly Summary - ${B(t.start)} to ${B(t.end)}

Time Breakdown:
• Total Time: ${A(o.total)}
• Deep Work: ${A(o.deepWork)}
• Shallow Work: ${A(o.shallowWork)}
• Meetings: ${A(o.meetings)}
• Planning: ${A(o.planning)}

Project Time Allocation:
${p.map(l=>`• ${l.projectName}${l.projectTeam?` (${l.projectTeam})`:""}: ${A(l.minutes)}`).join(`
`)}

Completed This Week:
${b.map(l=>`• ${l}`).join(`
`)}

In Progress:
${h.map(l=>`• ${l}`).join(`
`)}

Generated on ${B(new Date)}`;f(N)},d=async()=>{try{await navigator.clipboard.writeText(c),T.success("Summary copied to clipboard!")}catch{T.error("Failed to copy to clipboard")}},w=()=>{const b=`Weekly Summary - ${B(t.start)} to ${B(t.end)}`,h=encodeURIComponent(c);window.open(`mailto:?subject=${encodeURIComponent(b)}&body=${h}`)};u.useEffect(()=>{o.total>0&&I()},[o,s,n,p]);const S=()=>{const b=new Date(t.start);b.setDate(b.getDate()-7),a(Y(b))},M=()=>{const b=new Date(t.start);b.setDate(b.getDate()+7),a(Y(b))},E=()=>{a(Y())};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Weekly Summary"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:S,className:"btn-secondary",children:"← Previous"}),e.jsxs("span",{className:"font-medium",children:[B(t.start)," - ",B(t.end)]}),e.jsx("button",{onClick:M,className:"btn-secondary",children:"Next →"}),e.jsx("button",{onClick:E,className:"btn-primary",children:"Current Week"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Time"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(o.total)})]}),e.jsx(R,{className:"w-8 h-8 text-primary-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Deep Work"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(o.deepWork)}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:[o.total>0&&Math.round(o.deepWork/o.total*100),"%"]})]}),e.jsx(it,{className:"w-8 h-8 text-purple-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Shallow Work"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(o.shallowWork)}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:[o.total>0&&Math.round(o.shallowWork/o.total*100),"%"]})]}),e.jsx(Z,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Meetings"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(o.meetings)}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:[o.total>0&&Math.round(o.meetings/o.total*100),"%"]})]}),e.jsx(F,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Planning"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:A(o.planning)}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:[o.total>0&&Math.round(o.planning/o.total*100),"%"]})]}),e.jsx(Z,{className:"w-8 h-8 text-yellow-500"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Project Time Allocation"}),p.length>=$.weeklyReport.topProjects&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Top ",$.weeklyReport.topProjects," projects"]})]}),p.length>0?e.jsxs("div",{className:"space-y-3",children:[p.map((b,h)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-dark-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:b.projectName}),b.projectTeam&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:b.projectTeam})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("p",{className:"font-medium",children:A(b.minutes)}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.total>0?Math.round(b.minutes/o.total*100):0,"%"]})]})]},b.projectId||h)),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-blue-700 dark:text-blue-300",children:"Weekly Efficiency"}),e.jsxs("span",{className:"font-medium text-blue-800 dark:text-blue-200",children:[p.length," active projects"]})]})})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No time tracked this week."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Completed This Week"}),e.jsxs("button",{onClick:y,className:"btn-primary flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{children:"Add"})]})]}),e.jsx("div",{className:"space-y-2",children:s.map((b,h)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:b,onChange:N=>k(h,N.target.value),placeholder:"What did you complete?",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx("button",{onClick:()=>v(h),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400",children:e.jsx(ne,{className:"w-4 h-4"})})]},h))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"In Progress"}),e.jsxs("button",{onClick:j,className:"btn-primary flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{children:"Add"})]})]}),e.jsx("div",{className:"space-y-2",children:n.map((b,h)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:b,onChange:N=>C(h,N.target.value),placeholder:"What are you working on?",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx("button",{onClick:()=>D(h),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400",children:e.jsx(ne,{className:"w-4 h-4"})})]},h))})]})]}),c&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Email Summary"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:d,className:"btn-secondary flex items-center space-x-2",children:[e.jsx(ot,{className:"w-4 h-4"}),e.jsx("span",{children:"Copy"})]}),e.jsxs("button",{onClick:w,className:"btn-primary flex items-center space-x-2",children:[e.jsx(ct,{className:"w-4 h-4"}),e.jsx("span",{children:"Email"})]})]})]}),e.jsx("pre",{className:"bg-gray-50 dark:bg-dark-700 p-4 rounded-lg text-sm whitespace-pre-wrap",children:c})]}),!1]})},aa=()=>{const[t,a]=u.useState(localStorage.getItem("lastBackupDate")),[s,r]=u.useState(!1),[n,m]=u.useState(null),c=u.useRef(null);u.useEffect(()=>{f()},[]);const f=async()=>{const j=await Rt();m(j)},i=async()=>{await qe(),a(new Date().toISOString()),await f()},o=()=>{var j;(j=c.current)==null||j.click()},p=async j=>{var C;const D=(C=j.target.files)==null?void 0:C[0];if(D){const I=await Wt(D);if(!I.valid){T.error(`Invalid backup file: ${I.error}`);return}const d=I.stats,w=`Import backup from ${d.exportDate}?

Projects: ${d.projects}
Teams: ${d.teams}
Time Blocks: ${d.timeBlocks}
Active Timers: ${d.activeTimers}

This will replace all existing data. Continue?`;if(!window.confirm(w)){c.current&&(c.current.value="");return}await Ot(D),c.current&&(c.current.value="")}},y=async()=>{if(!s){r(!0);return}try{await g.timeBlocks.clear(),await g.projects.clear(),await g.teams.clear(),await g.activeTimers.clear(),await g.weeklySummaries.clear(),await g.preferences.clear(),localStorage.removeItem("lastBackupDate"),a(null),T.success("All data cleared successfully"),r(!1),setTimeout(()=>window.location.reload(),1e3)}catch(j){T.error("Failed to clear data: "+j.message),r(!1)}},v=()=>{r(!1)},k=j=>j?new Date(j).toLocaleString():"Never";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Settings"}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(dt,{className:"w-6 h-6 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Data Management"})]}),e.jsxs("div",{className:"space-y-4",children:[n&&e.jsxs("div",{className:"bg-blue-50 dark:bg-dark-700 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Export Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Projects"}),e.jsx("p",{className:"font-medium dark:text-gray-200",children:n.counts.projects})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Teams"}),e.jsx("p",{className:"font-medium dark:text-gray-200",children:n.counts.teams})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Time Blocks"}),e.jsx("p",{className:"font-medium dark:text-gray-200",children:n.counts.timeBlocks})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Active Timers"}),e.jsx("p",{className:"font-medium dark:text-gray-200",children:n.counts.activeTimers})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-dark-600",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Total Records: ",n.totalRecords]})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-dark-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Last Backup"}),e.jsx("p",{className:"font-medium dark:text-gray-200",children:k(t)})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-dark-600 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Export Data"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Download a backup of all your data as a JSON file"}),n&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[n.totalRecords," records ready for export"]})]}),e.jsxs("button",{onClick:i,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-dark-600 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Import Data"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Restore data from a backup file (this will replace all existing data)"}),e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-1",children:"⚠️ This will overwrite all current data. Export first as backup!"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:c,type:"file",accept:".json",onChange:p,className:"hidden"}),e.jsxs("button",{onClick:o,className:"btn-secondary flex items-center space-x-2",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{children:"Import"})]})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(mt,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Privacy & Storage"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"w-5 h-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Local Storage Only"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"All your data is stored locally in your browser using IndexedDB. No data is sent to external servers."})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"w-5 h-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"No Analytics or Tracking"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This application doesn't use any analytics, tracking, or third-party services."})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(F,{className:"w-5 h-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Offline Capable"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"The application works completely offline after the initial load."})]})]})]})]}),e.jsxs("div",{className:"card border-red-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(H,{className:"w-6 h-6 text-red-600"}),e.jsx("h3",{className:"text-lg font-semibold text-red-600",children:"Danger Zone"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Clear All Data"}),e.jsx("p",{className:"text-sm text-red-700 mb-4",children:"This will permanently delete all your time blocks, projects, teams, active timers, and settings. This action cannot be undone. Make sure to export your data first!"}),s?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"font-medium text-red-800",children:"Are you absolutely sure? This will delete everything!"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:y,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium",children:"Yes, Delete Everything"}),e.jsx("button",{onClick:v,className:"btn-secondary",children:"Cancel"})]})]}):e.jsxs("button",{onClick:y,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium flex items-center space-x-2",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:"Clear All Data"})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"About"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," 1.0.0"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Built with:"})," React, Vite, Tailwind CSS, Dexie.js"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"License:"})," MIT"]}),e.jsx("p",{children:"A productivity dashboard designed for technical writers to track time, manage projects, and generate weekly reports."})]})]})]})};function sa(){return u.useEffect(()=>{setTimeout(async()=>{try{await Mt(),await $t()}catch(a){console.error("Migration failed:",a)}},1e3)},[]),e.jsx(W,{fallbackMessage:"The Technical Writer Dashboard encountered an error. Please try refreshing the page.",children:e.jsx(wt,{children:e.jsx(Et,{children:e.jsx(Qe,{basename:"/technical-writer-dashboard/",children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 dark:from-dark-900 dark:via-dark-800 dark:to-indigo-950 transition-all duration-500",children:[e.jsx(W,{fallbackMessage:"Navigation component failed to load.",children:e.jsx(Lt,{})}),e.jsx("main",{className:"container mx-auto px-4 py-8 pb-20 md:pb-8",children:e.jsxs(Xe,{children:[e.jsx(V,{path:"/",element:e.jsx(W,{fallbackMessage:"Dashboard component failed to load.",children:e.jsx(Gt,{})})}),e.jsx(V,{path:"/time",element:e.jsx(W,{fallbackMessage:"Time Tracker component failed to load.",children:e.jsx(Qt,{})})}),e.jsx(V,{path:"/projects",element:e.jsx(W,{fallbackMessage:"Project Manager component failed to load.",children:e.jsx(Kt,{})})}),e.jsx(V,{path:"/teams",element:e.jsx(W,{fallbackMessage:"Team Manager component failed to load.",children:e.jsx(Zt,{})})}),e.jsx(V,{path:"/weekly",element:e.jsx(W,{fallbackMessage:"Weekly Summary component failed to load.",children:e.jsx(ta,{})})}),e.jsx(V,{path:"/settings",element:e.jsx(W,{fallbackMessage:"Settings component failed to load.",children:e.jsx(aa,{})})})]})}),e.jsx(W,{fallbackMessage:"Mobile navigation failed to load.",children:e.jsx(Ft,{})}),e.jsx(W,{fallbackMessage:"Active timer display failed to load.",children:e.jsx(Vt,{})}),e.jsx(xt,{position:"top-right",toastOptions:{className:"dark:bg-dark-800 dark:text-white",style:{background:"var(--toast-bg)",color:"var(--toast-color)"}}})]})})})})})}ie.createRoot(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(sa,{})}));
